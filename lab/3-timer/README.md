# Лабораторная работа 3. Таймеры

## Цели работы

1. Получить базовые знания об устройстве и режимах работы таймеров в микроконтроллерах.

2. Получить навыки использования таймеров и прерываний от таймеров.

3. Получить навыки использования аппаратных каналов ввода-вывода таймеров.

## Задание

Разработать программу, которая использует таймеры для управления яркостью светодиодов и излучателем звука (по прерыванию или с использованием аппаратных каналов). Блокирующее ожидание (функция HAL_Delay()) в программе использоваться не должно.

Стенд должен поддерживать связь с компьютером по UART и выполнять указанные действия в качестве реакции на нажатие кнопок на клавиатуре компьютера. В данной лабораторной работе каждая нажатая кнопка (символ, отправленный с компьютера на стенд) обрабатываются отдельно, ожидание ввода полной строки не требуется.

Для работы с UART на стенде можно использован один из двух вариантов драйвера (по прерыванию и по опросу) на выбор исполнителя. Поддержка двух вариантов не требуется.

Частота синхросигнала процессорного ядра и сигнала ШИМ для управления яркостью светодиодов (если используется) должны соответствовать указанным в варианте задания.

## Порядок выполнения работы

### Изучить

- разделы учебного пособия: 1.5. Программируемые таймеры;

- электрическую принципиальную схему стенда в части излучателя звука;

- разделы справочного руководства RM0090:
  
  1. Basic timers (TIM6 and TIM7);
  
  2. General-purpose timers (TIM2 to TIM5);
  
  3. General-purpose timers (TIM9 to TIM14);
  
  4. Advanced-control timers (TIM1 and TIM8);

- состав стандартных драйверов таймеров из библиотеки HAL и содержимое создаваемых генератором файлов tim.c/.h (появляются в проекте после настройки таймеров в графическом конфигураторе).

### Подготовить шаблон проекта для STM32CubeIDE, настроить тактовые частоты

### Настроить входы и выходы микроконтроллера, таймеры и UART

### Разработать необходимые драйверы управляемых светодиодов

Подготовить формулы для расчета необходимых частот, после выполнения работы включить их в отчет с объяснением, как они реализуются в программе.

### Разработать прикладную программу согласно варианту задания и протестировать ее

## Вариант 4

Реализовать «музыкальную шкатулку» с мелодиями, которые состоят из последовательности звуков определенной частоты и длительности, а также пауз. Шкатулка должна иметь четыре стандартные мелодии и одну пользовательскую, которую можно настроить.

Действия стенда при получении символов от компьютера.

- `1 - 4`: Воспроизведение одной из стандартных мелодий.

- `5`: Воспроизведение пользовательской мелодии.

- `Enter`: Вход в меню настройки.

- `*`: Ввод параметров пользовательской мелодии: частота (нота, октава), длительность, конец мелодии и т. п.

После ввода каждого символа в UART должно выводиться сообщение о том, какой режим активирован, или текущие настройки, вводимые в меню.

Частота процессорного ядра – 180 МГц.
